---
name: requirements-definition
description: ソフトウェア開発プロジェクトの要件定義を対話的に行うためのワークフローガイド。機能要件・非機能要件・技術スタックを構造化して引き出し、明確なドキュメントを作成。ユーザーが「要件定義をしたい」「要件を整理したい」「新しいプロジェクトの要件を決めたい」「機能要件を洗い出したい」などと言及した場合にトリガー。
---

# 要件定義ワークフロー

このスキルは、ソフトウェア開発プロジェクトの要件定義を対話的に行うためのワークフローを提供する。質問を通じて要件を引き出し、構造化されたドキュメントを作成する。

## ワークフロー概要

要件定義は以下の5フェーズで進行：

1. **プロジェクト概要の把握** - 背景、目的、スコープを明確化
2. **機能要件の定義** - システムが実現すべき機能を洗い出し
3. **非機能要件の定義** - 品質特性、制約条件を特定
4. **技術スタック決定** - 技術選定とアーキテクチャ決定
5. **要件の整理と確認** - 優先度付けと最終確認

## フェーズ1：プロジェクト概要の把握

### 基本質問

以下の観点でヒアリングを行う：

1. **プロジェクトの背景**
   - このプロジェクトを始めるきっかけは何ですか？
   - 現状の課題や問題点は何ですか？

2. **目的とゴール**
   - このシステムで何を実現したいですか？
   - 成功の基準は何ですか？

3. **ステークホルダー**
   - 主な利用者は誰ですか？
   - 意思決定者や承認者は誰ですか？

4. **スコープ**
   - 対象範囲に含めるものは何ですか？
   - 明確に対象外とするものはありますか？

5. **制約条件**
   - 予算、期限、技術的制約はありますか？
   - 既存システムとの連携は必要ですか？

### 深掘り質問（カテゴリ別）

| カテゴリ | 深掘り質問 |
|---------|----------|
| **背景・課題** | その課題が発生した根本原因は何ですか？いつ頃から発生していますか？影響範囲はどの程度ですか？過去に試した対策はありますか？その結果は？ |
| **目的・ゴール** | 定量的な目標値はありますか？短期（3ヶ月）/中期（1年）/長期（3年）のゴールは？KPI（重要業績評価指標）は何ですか？ |
| **ステークホルダー** | 各ステークホルダーの期待・要望は何ですか？懸念点はありますか？優先順位の最終決定権は誰にありますか？ |
| **スコープ** | 将来的に拡張したい範囲はありますか？MVP（Minimum Viable Product）として最低限必要な範囲は？Phase2以降で対応予定の機能は？ |
| **制約条件** | 技術的な制約がある場合、その背景は何ですか？予算の内訳はどうなっていますか？期限の根拠は何ですか（イベント、規制対応など）？ |
| **競合・市場** | 類似サービスや競合製品はありますか？差別化ポイントは何ですか？参考にしたいサービスや避けたいサービスはありますか？ |

### ヒアリングの進め方

- **1つの回答に対して最低2〜3回は深掘りする**
- **「なぜ？」「具体的には？」「他には？」を繰り返す**
- 曖昧な回答は具体例を求めて明確化する
- 矛盾があれば即座に指摘して解消する
- 仮説を立てて確認する（「〜ということですか？」）

## フェーズ2：機能要件の定義

### ユーザー種別の特定

まず、システムを利用するユーザーの種類を特定：

```
例：
- 一般ユーザー（閲覧・操作）
- 管理者（設定・管理）
- システム管理者（保守・監視）
```

### 基本質問

各ユーザー種別について：

1. **主要な操作**
   - そのユーザーは主に何をしますか？
   - 最も頻繁に行う操作は何ですか？

2. **具体的なシナリオ**
   - 典型的な利用シーンを教えてください
   - 開始から終了までの流れは？

3. **入出力**
   - どのようなデータを入力しますか？
   - どのような結果・出力を期待しますか？

### 深掘り質問（カテゴリ別）

| カテゴリ | 深掘り質問 |
|---------|----------|
| **ユーザー理解** | そのユーザーの1日の業務フローは？現在どのように作業していますか？最も困っている点（ペインポイント）は？理想的な状態は？ |
| **利用シーン** | いつ（時間帯、頻度）使いますか？どこで（オフィス、外出先）使いますか？どのデバイス（PC、スマホ、タブレット）で使いますか？ネットワーク環境は？ |
| **データフロー** | データの発生源はどこですか？データの加工・変換は必要ですか？保存期間や削除ルールはありますか？誰がデータを閲覧・編集できますか？ |
| **エッジケース** | 例外的なケースは何がありますか？エラーが発生したときの対応は？大量データの場合はどうなりますか？同時に複数人が操作したらどうなりますか？ |
| **画面イメージ** | 参考にしたいUI・サービスはありますか？絶対に避けたいUIやデザインは？一覧表示の1ページあたりの件数は？ |
| **優先順位** | この機能がないと何が困りますか？代替手段や回避策はありますか？最初のリリースに必須ですか？ |

### 機能の網羅性チェック

各機能について以下を必ず確認：

- **CRUD（作成・読取・更新・削除）** - 全てが必要か、一部のみか
- **一覧/詳細/検索/ソート/フィルター** - それぞれの要否
- **バッチ処理/リアルタイム処理** - 処理タイミングの要件
- **通知/アラート機能** - どのような条件でどこに通知するか
- **インポート/エクスポート** - データの入出力形式
- **履歴/監査ログ** - 変更履歴の保存要否

### 機能要件の記述形式

```markdown
### FR-XXX: [機能名]

**概要**: [機能の簡潔な説明]

**アクター**: [この機能を使用するユーザー種別]

**事前条件**: [この機能を実行するための前提条件]

**基本フロー**:
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

**代替フロー**: [例外的な処理パス]

**事後条件**: [機能実行後の状態]

**優先度**: 必須 / 重要 / あれば良い
```

## フェーズ3：非機能要件の定義

### 非機能要件のカテゴリ

以下のカテゴリについてヒアリング：

| カテゴリ | 質問例 |
|---------|--------|
| **性能** | 同時接続ユーザー数は？応答時間の許容範囲は？ |
| **可用性** | 稼働時間の要件は？メンテナンス時間は許容される？ |
| **セキュリティ** | 認証方式は？データの暗号化は必要？ |
| **拡張性** | 将来のユーザー数増加の見込みは？ |
| **保守性** | ログ出力は必要？監視・アラートは？ |
| **互換性** | 対応ブラウザ・OS・デバイスは？ |
| **法規制** | 準拠すべき法律・規制は？ |

### 非機能要件の記述形式

```markdown
### NFR-XXX: [要件名]

**カテゴリ**: [性能/可用性/セキュリティ等]

**要件**: [具体的な要件内容]

**測定基準**: [達成を確認する方法]

**優先度**: 必須 / 重要 / あれば良い
```

## フェーズ4：技術スタック決定

### 4.1 技術カテゴリ別のヒアリング項目

| カテゴリ | 質問例 |
|---------|--------|
| **フロントエンド** | SPAが必要ですか？SSRは必要ですか？モバイル対応は？リアルタイム更新は必要ですか？ |
| **バックエンド** | 言語やフレームワークの好み・経験は？マイクロサービスとモノリスどちらが適切ですか？ |
| **データベース** | RDBとNoSQLどちらが適切ですか？トランザクション要件は？データ量の見込みは？ |
| **インフラ** | クラウドとオンプレミスどちらですか？コンテナ化は必要ですか？サーバーレスは検討しますか？ |
| **認証・セキュリティ** | OAuth/SAML/独自認証どれが必要ですか？多要素認証は必要ですか？権限管理の複雑さは？ |
| **外部連携** | 連携が必要な外部API・サービスは？メッセージング（Pub/Sub等）は必要ですか？ |
| **CI/CD・DevOps** | デプロイ頻度の目標は？ブランチ戦略の好みは？監視・ログ収集の要件は？ |
| **テスト戦略** | 必要なテストレベル（単体/結合/E2E）は？自動化の範囲は？品質基準（カバレッジ等）は？ |

### 4.2 技術選定の判断基準

以下の観点で技術選定を行う：

- **チームのスキルセット** - 既存の技術経験、学習コスト
- **既存システムとの親和性** - 連携のしやすさ、統一性
- **ライセンス・コスト** - 初期費用、運用費用、ライセンス形態
- **コミュニティ・サポート** - ドキュメントの充実度、サポート体制
- **スケーラビリティ要件** - 将来の拡張性、性能要件への対応

### 4.3 技術スタック記述形式

```markdown
### TS-XXX: [技術カテゴリ]

**選定技術**: [技術名・バージョン]

**選定理由**: [なぜこの技術を選んだか]

**代替候補**: [検討した他の選択肢]

**不採用理由**: [代替候補を選ばなかった理由]

**リスク**: [採用に伴うリスク]

**必要スキル**: [チームに求められるスキル]
```

### 4.4 技術スタックのカテゴリ一覧

以下のカテゴリについて決定：

1. **フロントエンド**
   - フレームワーク（React, Vue, Angular等）
   - UIライブラリ（MUI, Tailwind, Bootstrap等）
   - 状態管理（Redux, Zustand, Recoil等）

2. **バックエンド**
   - 言語・フレームワーク（Node.js, Python, Go, Java等）
   - APIアーキテクチャ（REST, GraphQL, gRPC等）

3. **データベース**
   - RDBMS（PostgreSQL, MySQL等）
   - NoSQL（MongoDB, DynamoDB, Redis等）

4. **インフラストラクチャ**
   - クラウドプロバイダー（AWS, GCP, Azure等）
   - コンテナ（Docker, Kubernetes等）
   - サーバーレス（Lambda, Cloud Functions等）

5. **CI/CD・DevOps**
   - CIツール（GitHub Actions, CircleCI, Jenkins等）
   - デプロイ戦略（Blue-Green, Canary等）
   - 監視・ログ（Datadog, CloudWatch, Prometheus等）

6. **テスト戦略**
   - 単体テストフレームワーク
   - E2Eテストツール（Playwright, Cypress等）
   - 品質基準（カバレッジ目標等）

7. **外部サービス連携**
   - 認証（Auth0, Firebase Auth, Cognito等）
   - メール・通知（SendGrid, Twilio等）
   - ストレージ（S3, Cloud Storage等）

## フェーズ5：要件の整理と確認

### 優先度の決定

収集した要件に対して優先度を付ける：

| 優先度 | 定義 |
|--------|------|
| **必須（Must）** | これがないとシステムとして成立しない |
| **重要（Should）** | 重要だが、最悪なくても運用可能 |
| **あれば良い（Could）** | あると便利だが、後回しにできる |

ユーザーに各要件の優先度を確認する。

### 最終確認

要件一覧を提示し、以下を確認：

1. 漏れている要件はないか
2. 優先度は適切か
3. 矛盾する要件はないか
4. 実現可能性に問題はないか
5. 技術スタックは要件を満たすか

## 出力形式

要件定義完了後、以下の構造でドキュメントを生成：

**注意事項**：
- **改訂履歴は記載しない**（バージョン管理はGit等で行うため）
- 作成日・作成者などのメタ情報も不要

```markdown
# [プロジェクト名] 要件定義書

## 1. プロジェクト概要
### 1.1 背景
### 1.2 目的
### 1.3 スコープ
### 1.4 ステークホルダー
### 1.5 制約条件

## 2. 機能要件
### 2.1 ユーザー種別
### 2.2 機能一覧
### 2.3 機能詳細
  - FR-001: [機能名]
  - FR-002: [機能名]
  ...

## 3. 非機能要件
### 3.1 性能要件
### 3.2 可用性要件
### 3.3 セキュリティ要件
### 3.4 その他の要件

## 4. 技術スタック
### 4.1 フロントエンド
### 4.2 バックエンド
### 4.3 データベース
### 4.4 インフラストラクチャ
### 4.5 CI/CD・DevOps
### 4.6 テスト戦略
### 4.7 外部サービス連携

## 5. 優先度マトリクス

## 6. 用語集（必要に応じて）
```

## マークダウンスキルとの連携

要件定義が完了したら、`markdown-writer`スキルを自動的に呼び出し、ドキュメントを整形する。

**連携時の指示**：
```
要件定義が完了しました。markdown-writerスキルを使用して、
上記の要件定義書を技術ドキュメントとして整形してください。
```

## ヒアリングのベストプラクティス

### 効果的な質問

- **オープンクエスチョン**：「どのような〜」「なぜ〜」で始める
- **具体化**：「例えば？」「具体的には？」
- **確認**：「〜という理解で合っていますか？」
- **深掘り**：「それはなぜですか？」「他には？」

### 避けるべきこと

- 誘導質問（答えを示唆する質問）
- 一度に複数の質問をする
- 技術用語を説明なしに使う
- 曖昧なまま先に進む

### 情報の整理

- ヒアリング中も定期的に要点をまとめる
- 不明点リストを作成し、後で確認する
- 矛盾があれば即座に指摘して解消する
- 各フェーズの終了時に確認を取る
